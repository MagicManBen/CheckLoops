    function downloadCSV(data, filename) {
        if (!data.length) return;
        
        // Create HTML that Excel will open with colors and formatting
        const headers = Object.keys(data[0]);
        const isComplaint = filename.includes('complaint');
        const isTraining = filename.includes('training');
        
        // Build colorful HTML table
        let html = '<html><head><meta charset="UTF-8">';
        html += '<style>';
        html += 'table { border-collapse: collapse; font-family: Arial;