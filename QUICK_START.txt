┌─────────────────────────────────────────────────────────────────────┐
│                    PARTNER STAFF FEATURE - COMPLETE                 │
│                         Quick Start Guide                           │
└─────────────────────────────────────────────────────────────────────┘

📋 IMPLEMENTATION CHECKLIST
═══════════════════════════════════════════════════════════════════════

✅ Step 1: Run SQL in Supabase
   ┌────────────────────────────────────────────────────────┐
   │ 1. Open Supabase Dashboard                             │
   │ 2. Go to SQL Editor                                    │
   │ 3. Copy content from create_partner_config_table.sql   │
   │ 4. Run the query                                       │
   └────────────────────────────────────────────────────────┘

✅ Step 2: Code Already Updated
   ┌────────────────────────────────────────────────────────┐
   │ ✓ Settings page has new Partner Staff section         │
   │ ✓ JavaScript functions added                          │
   │ ✓ Dashboard logic updated                             │
   │ ✓ Event listeners configured                          │
   └────────────────────────────────────────────────────────┘

✅ Step 3: Test the Feature
   ┌────────────────────────────────────────────────────────┐
   │ 1. Open your app in browser                            │
   │ 2. Navigate to Settings page                           │
   │ 3. Click "Partner Staff" accordion                     │
   │ 4. Select some staff members                           │
   │ 5. Click "Save All Settings"                           │
   │ 6. Go to Dashboard                                     │
   │ 7. Check "Partner In" shows ✓ or ✗ correctly          │
   └────────────────────────────────────────────────────────┘


🎯 HOW IT WORKS
═══════════════════════════════════════════════════════════════════════

Settings Page:
┌─────────────────────────────────────────────────────────────┐
│  ⚙️  Dashboard Settings                                      │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│                                                             │
│  ▼ 📊 Appointment Thresholds                                │
│     [OTD and Not BKD settings - already working]            │
│                                                             │
│  ▶ 👥 Partner Staff                    <-- NEW SECTION      │
│     ┌─────────────────────────────────────────────┐        │
│     │ Select which staff members are partners...  │        │
│     │                                             │        │
│     │ ☑ Dr Smith                                  │        │
│     │ ☐ Dr Jones                                  │        │
│     │ ☑ Dr Williams                               │        │
│     │ ☐ Nurse Brown                               │        │
│     │ ☑ Dr Anderson                               │        │
│     └─────────────────────────────────────────────┘        │
│                                                             │
│                            [Cancel]  [Save All Settings]    │
└─────────────────────────────────────────────────────────────┘

Dashboard:
┌──────────────────────────────────────────────────────────────┐
│  Week 1                                                      │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│  Monday         Tuesday         Wednesday                    │
│  20 Jan 2025    21 Jan 2025     22 Jan 2025                  │
│  ┌────────┐     ┌────────┐      ┌────────┐                  │
│  │ OTD    │     │ OTD    │      │ OTD    │                  │
│  │   25   │     │   22   │      │   18   │                  │
│  ├────────┤     ├────────┤      ├────────┤                  │
│  │Not BKD │     │Not BKD │      │Not BKD │                  │
│  │   30   │     │   25   │      │   20   │                  │
│  ├────────┤     ├────────┤      ├────────┤                  │
│  │Partner │     │Partner │      │Partner │                  │
│  │   ✓    │ <-- │   ✓    │ <--  │   ✗    │ <-- UPDATED!    │
│  ├────────┤     ├────────┤      ├────────┤                  │
│  │ Duty   │     │ Duty   │      │ Duty   │                  │
│  │   ✓    │     │   ✗    │      │   ✓    │                  │
│  └────────┘     └────────┘      └────────┘                  │
└──────────────────────────────────────────────────────────────┘

Legend:
  ✓ Green = At least ONE selected partner is working
  ✗ Red   = NO selected partners are working


📊 DATA FLOW
═══════════════════════════════════════════════════════════════════════

1. LOADING STAFF LIST
   ┌──────────────────────────────────────────────────────┐
   │ Query: emis_apps_filled                              │
   │   SELECT DISTINCT name_of_session_holder             │
   │   WHERE site_id = [user's site]                      │
   │                                                      │
   │ Result: ["Dr Smith", "Dr Jones", "Dr Williams", ...] │
   └──────────────────────────────────────────────────────┘
            ↓
   ┌──────────────────────────────────────────────────────┐
   │ Display as checkboxes in Settings                    │
   └──────────────────────────────────────────────────────┘

2. SAVING SELECTIONS
   ┌──────────────────────────────────────────────────────┐
   │ User checks: ☑ Dr Smith, ☑ Dr Williams              │
   └──────────────────────────────────────────────────────┘
            ↓
   ┌──────────────────────────────────────────────────────┐
   │ Save to: emis_rules                                  │
   │   site_id: 2                                         │
   │   rule_type: 'partner_staff'                         │
   │   rule_config: {                                     │
   │     "partners": ["Dr Smith", "Dr Williams"]          │
   │   }                                                  │
   └──────────────────────────────────────────────────────┘

3. DASHBOARD CHECK (for each day)
   ┌──────────────────────────────────────────────────────┐
   │ Query: emis_apps_filled                              │
   │   SELECT *                                           │
   │   WHERE "Appointment Date" = '2025-01-20'            │
   │     AND name_of_session_holder IN                    │
   │         ('Dr Smith', 'Dr Williams')                  │
   │   LIMIT 1                                            │
   └──────────────────────────────────────────────────────┘
            ↓
   ┌──────────────────────────────────────────────────────┐
   │ If rows found: hasPartner = true  → Show ✓          │
   │ If no rows:    hasPartner = false → Show ✗          │
   └──────────────────────────────────────────────────────┘


🔍 VERIFICATION QUERIES
═══════════════════════════════════════════════════════════════════════

-- Check if partner config exists
SELECT * FROM emis_rules WHERE rule_type = 'partner_staff';

-- See all available staff
SELECT DISTINCT name_of_session_holder 
FROM emis_apps_filled 
WHERE site_id = 2 
  AND name_of_session_holder IS NOT NULL
ORDER BY name_of_session_holder;

-- Check a specific date for partners
SELECT "Appointment Date", name_of_session_holder, "Slot Type"
FROM emis_apps_filled
WHERE "Appointment Date" = '2025-01-20'
  AND name_of_session_holder IN ('Dr Smith', 'Dr Williams')
LIMIT 10;


⚠️  TROUBLESHOOTING
═══════════════════════════════════════════════════════════════════════

Issue: No staff appear in Partner Staff section
Fix:  Check that emis_apps_filled has data in name_of_session_holder
      SELECT COUNT(*) FROM emis_apps_filled 
      WHERE name_of_session_holder IS NOT NULL;

Issue: Save button doesn't work
Fix:  Open browser console (F12) and check for errors
      Verify RLS policies allow INSERT/UPDATE on emis_rules

Issue: Dashboard still shows all green ✓
Fix:  Reload the page after saving partners
      Check browser console for partner check errors

Issue: Partners not persisting after page reload
Fix:  Verify SQL was run successfully in Supabase
      Check emis_rules table has partner_staff row


📁 FILES REFERENCE
═══════════════════════════════════════════════════════════════════════

create_partner_config_table.sql      - SQL to run in Supabase
emis_reporting.html                  - Main app (already updated)
PARTNER_FEATURE_COMPLETE.md          - Full documentation
PARTNER_UI_EXAMPLE.html              - Visual preview of UI
QUICK_START.txt                      - This file


✅ YOU'RE DONE!
═══════════════════════════════════════════════════════════════════════

The feature is fully implemented in your code. Just:
1. Run the SQL
2. Test it out
3. Enjoy! 🎉
