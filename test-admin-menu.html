<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Admin Menu</title>
    <link rel="stylesheet" href="staff.css">
</head>
<body>
    <div class="bg"><div class="wave"></div><div class="wave wave2"></div></div>
    <main class="content">
        <div class="topbar panel" style="position:relative;">
            <div class="halo"></div>
            <div class="nav seg-nav">
                <!-- Navigation will be rendered by staff-common.js -->
            </div>
            <div class="spacer"></div>
            <div class="pill" id="site-pill">Site: —</div>
            <div class="pill" id="email-pill">—</div>
            <div class="pill" id="role-pill">—</div>
            <button class="btn" id="logout-btn">Sign Out</button>
        </div>

        <section class="panel g-12" style="margin:0; position:relative; overflow:hidden;">
            <div class="halo"></div>
            <h1>Test Admin Menu</h1>
            <p>This page tests the Admin Portal button in the navigation menu.</p>
            
            <div style="margin: 20px 0;">
                <button onclick="testAsAdmin()">Test as Admin</button>
                <button onclick="testAsStaff()">Test as Staff</button>
                <button onclick="testAsOwner()">Test as Owner</button>
            </div>
            
            <div id="status" style="margin: 20px 0; padding: 10px; background: #f0f0f0; border-radius: 5px;">
                Navigation not yet loaded
            </div>
        </section>
    </main>

    <script type="module">
        import { renderStaffNavigation, setTopbar } from './staff-common.js';

        // Initialize navigation without user data first
        renderStaffNavigation('home');
        
        window.testAsAdmin = function() {
            setTopbar({ 
                siteText: 'Test Site', 
                email: 'admin@test.com', 
                role: 'admin' 
            });
            updateStatus('Tested as Admin - Admin Portal should appear in navigation');
        };
        
        window.testAsStaff = function() {
            setTopbar({ 
                siteText: 'Test Site', 
                email: 'staff@test.com', 
                role: 'staff' 
            });
            updateStatus('Tested as Staff - Admin Portal should NOT appear in navigation');
        };
        
        window.testAsOwner = function() {
            setTopbar({ 
                siteText: 'Test Site', 
                email: 'owner@test.com', 
                role: 'owner' 
            });
            updateStatus('Tested as Owner - Admin Portal should appear in navigation');
        };
        
        function updateStatus(message) {
            const statusDiv = document.getElementById('status');
            const adminBtn = document.querySelector('button[data-section="admin-portal"]');
            const adminVisible = adminBtn ? 'VISIBLE' : 'NOT VISIBLE';
            statusDiv.innerHTML = `
                <strong>${message}</strong><br>
                Admin Portal button in navigation: <strong>${adminVisible}</strong><br>
                Current navigation buttons: ${Array.from(document.querySelectorAll('.nav button')).map(b => b.textContent).join(', ')}
            `;
        }
        
        // Initial status
        updateStatus('Navigation loaded. Click buttons above to test different roles.');
    </script>
</body>
</html>